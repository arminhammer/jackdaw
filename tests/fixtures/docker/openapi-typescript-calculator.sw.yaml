document:
  dsl: '1.0.1'
  namespace: calculator
  name: openapi-typescript-calculator
  version: '1.0.0'
  title: OpenAPI Calculator with TypeScript Handler
  summary: Test HTTP/OpenAPI listener with TypeScript handlers

do:
  - performAddition:
      listen:
        to:
          any:
            - with:
                source:
                  uri: http://0.0.0.0:8080/api/v1/add
                  schema:
                    format: openapi
                    resource:
                      endpoint: tests/fixtures/listeners/specs/calculator.yaml
                      name: AddRequest
          until: '${ false }'
      foreach:
        item: event
        do:
          - executeAdd:
              call: typescript
              with:
                module: calculator.add
                function: handler
                arguments:
                  - ${ $event }